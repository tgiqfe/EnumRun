(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{448:function(s,t,a){"use strict";a.r(t);var e=a(62),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"ログ転送-syslogサーバ側設定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ログ転送-syslogサーバ側設定"}},[s._v("#")]),s._v(" ログ転送(Syslogサーバ側設定)")]),s._v(" "),a("p",[s._v("Linux前提。"),a("br"),s._v("\nSyslogのWindows Serverは割愛。")]),s._v(" "),a("h2",{attrs:{id:"必要パッケージ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#必要パッケージ"}},[s._v("#")]),s._v(" 必要パッケージ")]),s._v(" "),a("ul",[a("li",[s._v("rsyslog")]),s._v(" "),a("li",[s._v("gnutls-utils ※TLS暗号化する場合のみ")]),s._v(" "),a("li",[s._v("rsyslog-gnutls ※TLS暗号化する場合のみ")])]),s._v(" "),a("p",[a("code",[s._v("rsyslog")]),s._v("は恐らくOSインストール時に同時インストールされる為、気にしなくてOK。")]),s._v(" "),a("h2",{attrs:{id:"各通信用設定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#各通信用設定"}},[s._v("#")]),s._v(" 各通信用設定")]),s._v(" "),a("h3",{attrs:{id:"udp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#udp"}},[s._v("#")]),s._v(" UDP")]),s._v(" "),a("p",[s._v("コンフィグファイル"),a("code",[s._v("/etc/rsyslog.conf")]),s._v("を、以下のように変更。")]),s._v(" "),a("p",[s._v("設定箇所 (変更前)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides UDP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imudp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imudp" port="514")')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides TCP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imtcp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imtcp" port="514")')]),s._v("\n")])])]),a("p",[s._v("設定箇所 (変更後)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides UDP syslog reception")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("load"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"imudp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ninput"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"imudp"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"514"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides TCP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imtcp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imtcp" port="514")')]),s._v("\n")])])]),a("h3",{attrs:{id:"tcp-暗号化無し"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-暗号化無し"}},[s._v("#")]),s._v(" TCP(暗号化無し)")]),s._v(" "),a("p",[s._v("コンフィグファイル"),a("code",[s._v("/etc/rsyslog.conf")]),s._v("を、以下のように変更。")]),s._v(" "),a("p",[s._v("設定箇所 (変更前)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides UDP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imudp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imudp" port="514")')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides TCP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imtcp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imtcp" port="514")')]),s._v("\n")])])]),a("p",[s._v("設定箇所 (変更後)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides UDP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imudp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imudp" port="514")')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides TCP syslog reception")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("load"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"imtcp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ninput"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"imtcp"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"514"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("h3",{attrs:{id:"tcp-tls暗号化、クライアント認証無し"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-tls暗号化、クライアント認証無し"}},[s._v("#")]),s._v(" TCP(TLS暗号化、クライアント認証無し)")]),s._v(" "),a("p",[s._v("事前に必要パッケージをインストール")]),s._v(" "),a("p",[s._v("Ubuntu")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gnutls-utils\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" rsyslog-gnutls\n")])])]),a("p",[s._v("CentOS")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("dnf "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gnutls-utils\ndnf "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" rsyslog-gnutls\n")])])]),a("p",[s._v("コンフィグファイル"),a("code",[s._v("/etc/rsyslog.conf")]),s._v("を、以下のように変更。")]),s._v(" "),a("p",[s._v("設定箇所 (変更前)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides UDP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imudp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imudp" port="514")')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides TCP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imtcp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imtcp" port="514")')]),s._v("\n")])])]),a("p",[s._v("設定箇所 (変更後)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides UDP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imudp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imudp" port="514")')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides TCP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imtcp")')]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("load")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"imtcp"')]),s._v("\n  StreamDriver.Name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gtls"')]),s._v("\n  StreamDriver.Mode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v("\n  StreamDriver.Authmode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"anon"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ninput"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"imtcp"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"514"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nglobal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DefaultNetstreamDriver")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gtls"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DefaultNetstreamDriverCAFile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/rsyslog.d/tls/rootCA.crt"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DefaultNetstreamDriverCertFile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/rsyslog.d/tls/cert.crt"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DefaultNetstreamDriverKeyFile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/rsyslog.d/tls/cert.key"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[a("code",[s._v("StreamDriver.Authmode")]),s._v("の値を"),a("code",[s._v("anon")]),s._v("に設定。")])]),s._v(" "),a("h3",{attrs:{id:"tcp-tls暗号化、クライアント認証有り"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp-tls暗号化、クライアント認証有り"}},[s._v("#")]),s._v(" TCP(TLS暗号化、クライアント認証有り)")]),s._v(" "),a("p",[s._v("事前に必要パッケージをインストール"),a("br"),s._v("\n⇒ "),a("a",{attrs:{href:"#tcp%E6%9A%97%E5%8F%B7%E5%8C%96-tls%E6%9A%97%E5%8F%B7%E5%8C%96%E3%80%81%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E8%AA%8D%E8%A8%BC%E7%84%A1%E3%81%97"}},[s._v("TCP暗号化(TLS暗号化、クライアント認証無し)")]),s._v("を参照")]),s._v(" "),a("p",[s._v("コンフィグファイル"),a("code",[s._v("/etc/rsyslog.conf")]),s._v("を、以下のように変更。")]),s._v(" "),a("p",[s._v("設定箇所 (変更前)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides UDP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imudp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imudp" port="514")')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides TCP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imtcp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imtcp" port="514")')]),s._v("\n")])])]),a("p",[s._v("設定箇所 (変更後)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides UDP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imudp")')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#input(type="imudp" port="514")')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides TCP syslog reception")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#module(load="imtcp")')]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("load")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"imtcp"')]),s._v("\n  StreamDriver.Name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gtls"')]),s._v("\n  StreamDriver.Mode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v("\n  StreamDriver.Authmode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x509/name"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PermittedPeer")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"クライアント証明書のCN名"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ninput"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"imtcp"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"514"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nglobal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DefaultNetstreamDriver")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gtls"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DefaultNetstreamDriverCAFile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/rsyslog.d/tls/ca.crt"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DefaultNetstreamDriverCertFile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/rsyslog.d/tls/cert.crt"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DefaultNetstreamDriverKeyFile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/rsyslog.d/tls/cert.key"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[a("code",[s._v("StreamDriver.Authmode")]),s._v("の値を"),a("code",[s._v("x509/name")]),s._v("に設定。")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[a("code",[s._v("PermittedPeer")]),s._v("の値は、クライアント証明書のCN名 (FQDN必須) に合わせる必要有り。")])]),s._v(" "),a("p",[s._v("暗号化通信うる場合は、ルート証明書(必要に応じて中間証明書も含む)を、Syslogクライアントに予めインストールしておく必要有り。")]),s._v(" "),a("h2",{attrs:{id:"出力用設定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#出力用設定"}},[s._v("#")]),s._v(" 出力用設定")]),s._v(" "),a("h3",{attrs:{id:"ファシリティごとに対象外設定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ファシリティごとに対象外設定"}},[s._v("#")]),s._v(" ファシリティごとに対象外設定")]),s._v(" "),a("p",[s._v("初期状態は、"),a("code",[s._v("/etc/rsyslog.conf")]),s._v("もしくは、"),a("code",[s._v("/etc/rsyslog.d/配下の*.conf")]),s._v("のどこかに記述されている、")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("*.*;auth,authpriv.none              -/var/log/syslog\n")])])]),a("p",[s._v("の設定により、アプリケーションが送ったSyslogデータは全て"),a("code",[s._v("/var/log/syslog")]),s._v("ファイルにまとめられて、闇鍋になってします。\n(ディストリビューションにより、出力先ファイルの名前が異なる可能性有り)")]),s._v(" "),a("p",[s._v("事前に決めたファシリティを、闇鍋対象がにする為には、"),a("br"),s._v("\n(ファシリティ"),a("code",[s._v("local0")]),s._v("を対象外にする場合)")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("*.*;auth,authpriv.none,local0.none              -/var/log/syslog\n")])])]),a("p",[s._v("のように設定。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("ファイル名の前の「- (ハイフン)」は、非同期書き込みするという設定。"),a("br"),s._v("\n「-」無しの場合は同期書き込み。"),a("br"),s._v("\n非同期書き込みのほうがパフォーマンスが良いとのこと。")])]),s._v(" "),a("h3",{attrs:{id:"対象ファシリティを特定のファイルに設定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#対象ファシリティを特定のファイルに設定"}},[s._v("#")]),s._v(" 対象ファシリティを特定のファイルに設定")]),s._v(" "),a("p",[a("code",[s._v("/etc/rsyslog.conf")]),s._v("もしくは、"),a("code",[s._v("/etc/rsyslog.d/配下の*.conf")]),s._v("のファイルに、以下のように追記する。"),a("br"),s._v("\n(ファシリティ"),a("code",[s._v("local0")]),s._v("を対象外にする場合)")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("local0.debug            -/var/log/example.log\n")])])]),a("p",[s._v("何かあった時にファイル名変更や削除で容易に設定無効化ができる為、"),a("code",[s._v("/etc/rsyslog.c")]),s._v("配下に、新規ファイルを作成して設定を記述することをお勧めします。")]),s._v(" "),a("h3",{attrs:{id:"設定ファイルの構文チェック"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#設定ファイルの構文チェック"}},[s._v("#")]),s._v(" 設定ファイルの構文チェック")]),s._v(" "),a("p",[s._v("以下のように実行。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/rsyslog.conf をチェック")]),s._v("\nrsyslogd -N "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/rsyslog.d 配下の10-sample.conf をチェック")]),s._v("\nrsyslogd -N "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -f /etc/rsyslog.d/10-sample.conf\n")])])]),a("p",[s._v("構文に問題が無い場合は、以下のように出力される。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rsyslogd: version 8.2001.0, config validation run (level 1), master config /etc/rsyslog.d/60-test.conf\nrsyslogd: End of config validation run. Bye.\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("Syslogデータの出力先を設定した後、ログローテーションに設定を追加することも忘れずに。")])])])}),[],!1,null,null,null);t.default=r.exports}}]);